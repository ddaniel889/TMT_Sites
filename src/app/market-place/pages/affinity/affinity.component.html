
<div class="ps-site-features">
    <div class="container">  
        <div class="ps-section__content">
              <!-- Form Cotizacion -->
         
                <div class="ps-form__content">
                    <div class="row">
                        <div class="col-xl-8 col-lg-8 col-md-8 col-sm-12 col-12 ">
                            <div class="ps-form__billing-info affinity">
                             <form class="ps-form--checkout"  [formGroup]="cotizacion" (onSubmit)="verProductos()" *ngIf="cotiz">
                                <h3 class="ps-form__heading">Insurance</h3>
                                <div class="row">
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label for="sel1">Destiny:</label>
                                            <select class="form-control"   formControlName="destino" required  [ngClass]="{ 'valid-input': destino.valid, 'invalid-input': destino.invalid }">
                                              <option  value="1" >Estados Unidos e Canadá </option>
                                              <option  value="4">Brasil</option>
                                              <option  value="5" >Europa </option>
                                              <option  value="8">Demais países</option>
                                              <option  value="10" >América Latina </option>
                                           </select>
                                           <div class="invalid-label" *ngIf="destino.hasError('required')">Este campo é obrigatorio.</div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label for="sel1">Category - insurance:</label>
                                            <select class="form-control"   formControlName="categoria" required   [ngClass]="{ 'valid-input': categoria.valid, 'invalid-input': categoria.invalid }">
                                              <option  value="7" selected>Receptivo </option>
                                              <option  value="9">Corporativo Multiviagens</option>
                                              <option  value="11" >Estudante </option>
                                              <option  value="12">Semestral</option>
                                              <option  value="17">Lazer/Negócios</option>
                                              <option  value="18">Lazer/Negócios (Covid)</option>
                                           </select>
                                           <div class="invalid-label" *ngIf="categoria.hasError('required')">Este campo é obrigatorio.</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row"> 
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Departure date:</label>
                                            <input class="form-control" type="date"  formControlName="dataInicio"  [ngClass]="{ 'is-valid': dataInicio.valid, 'is-invalid': dataInicio.invalid }">
                                            <div class="invalid-feedback" *ngIf="dataInicio.hasError('required')">Este campo é obrigatorio.</div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Arrival date:</label>
                                            <input class="form-control" type="date"  formControlName="dataFim" [ngClass]="{ 'is-valid': dataFim.valid, 'is-invalid': dataFim.invalid }">
                                            <div class="invalid-feedback" *ngIf="dataFim.hasError('required')">Este campo é obrigatorio.</div>
                                        </div>
                                    </div>
                                </div>
                    
                                <div class="row"> 
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Numbers of passengers:</label>
                                            <input class="form-control" type="number"  min="0" formControlName="nPax" placeholder="" [ngClass]="{ 'is-valid': nPax.valid, 'is-invalid': nPax.invalid }">
                                            <div class="invalid-feedback" *ngIf="nPax.hasError('required')">Este campo é obrigatorio.</div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Family:</label>
                                            <input class="form-control" type="number" min="0" placeholder="" formControlName="familiar" [ngClass]="{ 'is-valid': familiar.valid, 'is-invalid': familiar.invalid }">
                                            <div class="invalid-feedback" *ngIf="familiar.hasError('required')">Este campo é obrigatorio.</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Id Cancel (Optional):</label>
                                            <input class="form-control" type="number" min="0" placeholder="" formControlName="cancelId">
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Id Covid (Optional):</label>
                                            <input class="form-control" type="number" min="0" placeholder="" formControlName="covidId">
                                        </div>
                                    </div>
                                </div>
                                <button class="ps-btn ps-btn--fullwidth" type="submit" (click)="verProductos()"  [disabled]="!loading && cotizacion.invalid">Calculate</button>    
                            </form>
                            </div>
                        </div>
                            <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 col-12">
                                <div class="ps-section__right affinity">
                                    <div class="ps-section--account-setting column_right">
                                        <div class="ps-section__header column_right">
                                            <h4 class="title-side">Choose your plan for your trip</h4>
                                        </div>
                                        <div class="ps-section__content">
                                            <div class="row">
                                                <div class="col-md-4 col-12">
                                                    <figure class="ps-block--invoice">
                                                        <figcaption>Address</figcaption>
                                                        <div class="ps-block__content"><strong>John Walker</strong>
                                                            <p>Address: 3481 Poe Lane, Westphalia, Kansas</p>
                                                            <p>Phone: 913-489-1853</p>
                                                        </div>
                                                    </figure>
                                                </div>
                                                <div class="col-md-4 col-12">
                                                    <figure class="ps-block--invoice">
                                                        <figcaption>Shipping Fee</figcaption>
                                                        <div class="ps-block__content">
                                                            <p>Shipping Fee: Free</p>
                                                        </div>
                                                    </figure>
                                                </div>
                                                <div class="col-md-4 col-12">
                                                    <figure class="ps-block--invoice">
                                                        <figcaption>Payment methods</figcaption>
                                                        <div class="ps-block__content">
                                                            <p><i class="fa fa-ticket ico"></i></p>
                                                        </div>
                                                    </figure>
                                                </div>
                                            </div>
                                           
                                        </div>
                                        <!--div class="ps-section__footer"><a class="ps-btn ps-btn--sm" href="#">Back to invoices</a></div-->
                                    </div>
                                </div>
                            </div>
                    </div>
                </div>
           
                <!-- Form Emisión -->
            <form class="ps-form--checkout"  [formGroup]="emision" (onSubmit)="procesoEmision()" *ngIf="proceso">
                <div class="ps-form__content">
                    <div class="row">
                        <div class="col-xl-8 col-lg-8 col-md-12 col-sm-12 col-12 ">
                            <div class="ps-form__billing-info affinity">
                               
                                <h3 class="ps-form__heading">Pasenger data</h3>
                                <div class="row">
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Firstname & Lastname:</label>
                                            <input class="form-control" type="text"  formControlName="pax"  [ngClass]="{ 'is-valid': pax.valid, 'is-invalid': pax.invalid }">
                                            <div class="invalid-feedback" *ngIf="pax.hasError('required')">Este campo é obrigatorio.</div>
                                            <small class="form-text text-muted invalid-label" *ngIf="pax.hasError('pattern')">
                                                Solo se permite caracteres alfabeticos para el nombre y apellido.
                                            </small>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label for="sel1">Sex:</label>
                                            <select class="form-control"   formControlName="paxSexo" required [ngClass]="{ 'valid-input': paxSexo.valid, 'invalid-input': paxSexo.invalid }">
                                              <option  value="F" selected>Female</option>
                                              <option  value="M">Male</option>
                                             
                                           </select>
                                           <div class="invalid-label" *ngIf="paxSexo.hasError('required')">Este campo é obrigatorio.</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">

                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Born date:</label>
                                            <input class="form-control" type="date"  formControlName="paxDataNasc" [ngClass]="{ 'is-valid': paxDataNasc.valid, 'is-invalid': paxDataNasc.invalid }">
                                            <div class="invalid-feedback" *ngIf="paxDataNasc.hasError('required')">Este campo é obrigatorio.</div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Age:</label>
                                            <input class="form-control" type="number" min="0"  formControlName="paxIdade" [ngClass]="{ 'is-valid': paxIdade.valid, 'is-invalid': paxIdade.invalid }">
                                            <div class="invalid-feedback" *ngIf="paxIdade.hasError('required')">Este campo é obrigatorio.</div>
                                        </div>
                                    </div>

                                </div>
                                <div class="row">
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Type of document:</label>
                                            <input class="form-control" type="text"  formControlName="paxDocTipo" [ngClass]="{ 'is-valid': paxDocTipo.valid, 'is-invalid': paxDocTipo.invalid }">
                                            <div class="invalid-feedback" *ngIf="paxDocTipo.hasError('required')">Este campo é obrigatorio.</div>
                                            <small class="form-text text-muted invalid-label" *ngIf="paxDocTipo.hasError('pattern')">
                                                Solo se permite caracteres alfabeticos para el tipo de documento de pasajero.
                                            </small>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Address:</label>
                                            <input class="form-control" type="text"  placeholder="" formControlName="paxEndereco" [ngClass]="{ 'is-valid': paxEndereco.valid, 'is-invalid': paxEndereco.invalid }">
                                            <div class="invalid-feedback" *ngIf="paxEndereco.hasError('required')">Este campo é obrigatorio.</div>
                                            <small class="form-text text-muted invalid-label" *ngIf="paxEndereco.hasError('pattern')">
                                                Solo se permite caracteres alfabeticos para la dirección de pasajero.
                                            </small>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Number:</label>
                                            <input class="form-control" type="number" min="0" placeholder="" formControlName="paxNumero" [ngClass]="{ 'is-valid': paxNumero.valid, 'is-invalid': paxNumero.invalid }">
                                            <div class="invalid-feedback" *ngIf="paxNumero.hasError('required')">Este campo é obrigatorio.</div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Cep:</label>
                                            <input class="form-control" type="text"  placeholder="" formControlName="paxCep" [ngClass]="{ 'is-valid': paxCep.valid, 'is-invalid': paxCep.invalid }">
                                            <div class="invalid-feedback" *ngIf="paxCep.hasError('required')">Este campo é obrigatorio.</div>
                                            <small class="form-text text-muted invalid-label" *ngIf="paxCep.hasError('pattern')">
                                                Solo se permite caracteres alfabeticos para la Cep de pasajero.
                                            </small>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Bairro:</label>
                                            <input class="form-control" type="text"  placeholder="" formControlName="paxBairro" [ngClass]="{ 'is-valid': paxBairro.valid, 'is-invalid': paxBairro.invalid }">
                                            <div class="invalid-feedback" *ngIf="paxBairro.hasError('required')">Este campo é obrigatorio.</div>
                                            <small class="form-text text-muted invalid-label" *ngIf="paxBairro.hasError('pattern')">
                                                Solo se permite caracteres alfabeticos para el nombre de barrio.
                                            </small>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Complemento:</label>
                                            <input class="form-control" type="text" min="0" placeholder="" formControlName="paxComplemento" [ngClass]="{ 'is-valid': paxComplemento.valid, 'is-invalid': paxComplemento.invalid }">
                                            <div class="invalid-feedback" *ngIf="paxComplemento.hasError('required')">Este campo é obrigatorio.</div>
                                            <small class="form-text text-muted invalid-label" *ngIf="paxComplemento.hasError('pattern')">
                                                Solo se permite caracteres alfabeticos para el dato de complemento.
                                            </small>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>City:</label>
                                            <input class="form-control" type="text"  placeholder="" formControlName="paxCidade" [ngClass]="{ 'is-valid': paxCidade.valid, 'is-invalid': paxCidade.invalid }">
                                            <div class="invalid-feedback" *ngIf="paxCidade.hasError('required')">Este campo é obrigatorio.</div>
                                            <small class="form-text text-muted invalid-label" *ngIf="paxCidade.hasError('pattern')">
                                                Solo se permite caracteres alfabeticos para la ciudad.
                                            </small>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>UF Code:</label>
                                            <input class="form-control" type="tex"  placeholder="" formControlName="paxUF" [ngClass]="{ 'is-valid': paxUF.valid, 'is-invalid': paxUF.invalid }">
                                            <div class="invalid-feedback" *ngIf="paxUF.hasError('required')">Este campo é obrigatorio.</div>
                                            <small class="form-text text-muted invalid-label" *ngIf="paxCidade.hasError('pattern')">
                                                Solo se permite caracteres alfabeticos para el código UF.
                                            </small>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Email:</label>
                                            <input class="form-control" type="text"  placeholder="" formControlName="paxEmail" [ngClass]="{ 'is-valid': paxEmail.valid, 'is-invalid': paxEmail.invalid }">
                                            <div class="invalid-feedback" *ngIf="paxEmail.hasError('required')">Este campo é obrigatorio.</div>
                                            <small class="form-text text-muted invalid-label" *ngIf="paxEmail.hasError('email')">
                                                Introduza um endereço de E-mail válido.
                                            </small>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Number of document:</label>
                                            <input class="form-control" type="number"  min="0" formControlName="paxDocNum" placeholder="" [ngClass]="{ 'is-valid': paxDocNum.valid, 'is-invalid': paxDocNum.invalid }">
                                            <div class="invalid-feedback" *ngIf="paxDocNum.hasError('required')">Este campo é obrigatorio.</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Local phone:</label>
                                            <input class="form-control" type="number" min="0" placeholder="" formControlName="paxTel" [ngClass]="{ 'is-valid': paxTel.valid, 'is-invalid': paxTel.invalid }">
                                            <div class="invalid-feedback" *ngIf="paxTel.hasError('required')">Este campo é obrigatorio.</div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Mobile phone:</label>
                                            <input class="form-control" type="number" min="0" placeholder="" formControlName="paxCel" [ngClass]="{ 'is-valid': paxCel.valid, 'is-invalid': paxCel.invalid }">
                                            <div class="invalid-feedback" *ngIf="paxCel.hasError('required')">Este campo é obrigatorio.</div>
                                        </div>
                                    </div>
                                </div>
                                <button class="ps-btn ps-btn--fullwidth" type="submit" (click)="nuevoPax()"  [disabled]="!loading && emision.invalid">Enviar</button>                            
                            </div>
                        </div>
                    </div>
                </div>
            </form>  
    
             <div class="total-process"> 
                <div class="ps-form__content" *ngIf="paxProcess">
                  <h4 class="ps-form__heading title">Passenger registered: <span class="pax">{{ nomPax }} </span></h4> 
                  <button class="ps-btn ps-btn btn-pax" type="submit" (click)="emitirProceso()" >Emitir proceso</button>
                </div>
                <div class="ps-form__content" *ngIf="vaucher">             
                  <button class="ps-btn ps-btn btn-vaucher" type="submit" (click)="verVaucher()" >Generar vaucher póliza</button>
                </div>
                <div class="ps-form__content poliza-content" *ngIf="doc">
                  <h3 class="plano-title document"><strong>{{ planoDoc }}</strong></h3>
                  <p class="document">Fecha de emisión<strong class="policy">{{ dataDoc }}</strong></p>
                  <p class="document">Duración<strong class="policy">{{ diasDoc }}</strong></p>
                  <p class="document">Fecha de inicio<strong class="policy">{{ inicioDoc }}</strong></p>
                  <p class="document">Fecha de fin<strong class="policy">{{ finDoc }}</strong></p>
                  <p class="document">Billete<strong class="policy">{{ bilheteDoc }}</strong></p>
                  <p class="document">Total Cambio<strong class="policy">{{ cambioDoc }}</strong></p>
                  <p class="document">Total cancelado<strong class="policy">{{ cancelDoc }}</strong></p>
                  <p class="document">Precio BRL<strong class="policy">{{ totalDoc }}</strong></p>
                  <h4 class="ps-form__heading title document">Descargar documento</h4>              
                  <p class="document"><a class="link poliza" href="{{ documento }}"><strong>Póliza </strong></a></p> 
                </div>
            </div>

              <!-- Plan card -->
            <div class="col-xl-8 col-lg-8 col-md-12 col-sm-12 col-12 section">
                <div class=" flighto" *ngIf="productos">
                    <h3 class="ps-form__heading title2">Planes de Asistencia</h3>
                    <div class="ps-block--checkout-order" *ngFor="let item of productList">
                        <div class="ps-block__content plan">
                            <figure>
                              <figcaption>
                                <strong class="flight">{{ item.planoNome }}</strong>
                                <h4 class="ps-product__price desc_marg subtitle"></h4><span class="subtitle">USD{{ item.valorPaxUSD }} </span>
                                <h4 class="ps-product__price desc_marg subtitle"></h4><span class="subtitle">BRL {{ item.valorPaxBRL }} </span>
                                <h4 class="ps-product__price desc_marg subtitle"></h4><span class="subtitle">Cambio {{ item.cambio }} </span> 
                                <span>       
                                    <a class="ps-btn btn-back" (click)="nuevoProceso( item.planoId )"><span class="buy">Comprar</span></a> 
                                </span>     
                              </figcaption>
                            </figure>
                            <table class="table">
                                <tr>
                                    <td class="air"> 
                                        <p class="obs">{{ item.obs }}</p> 
                                    <p><a class="link" href="{{ item.urlCobertura[0] }}"><br /><strong>Ver cobertura  </strong></a></p> <br /> 
                                    </td>  
                                    <td>  
                                     <span class="text-justify"> <span class="place"> Fecha de inicio:</span> <br /> 
                                     {{ item.dataInicio }}<br />
                                     Vigencia:<a href=""><strong> {{ item.vigencia }}</strong></a>
                                     </span> 
                                    </td>
                                    <td>  <span class="text-justify"><span class="place">Fecha de fin:</span><br /> {{ item.dataFim }}<br /> 
                                        <span class="time"> Rate:<a href=""><strong> {{ item.tipo_tarifa }}</strong></a> </span></span>
                                      </td>
                                </tr>
                                <tr>
                                    <td>Cancelamento Id:<a href=""><strong> {{ item.cancelId }}</strong></a> <br />Nombre:<a href=""><strong> {{ item.cancelNome }}</strong></a> </td>
                                    <td>Valor USD:<a href=""><strong>  {{ item.valorCancelUSD }}</strong></a>  <br />Valor BRL:<a href=""><strong>  {{ item.valorCancelBRL }}</strong></a>   </td>
                                    <td><a class="link" href="{{ item.urlCobertura[1] }}"><strong>Ver cobertura  </strong></a>   </td>
                                   
                                </tr>
                                <tr>
                                    <td> Covid Id:<a href=""><strong>  {{ item.covidId }}</strong></a> <br />Covid Nombre:<a href=""><strong> {{ item.covidNome }}</strong></a> </td>
                                    <td>Valor Covid USD:<a href=""><strong>  {{ item.valorCovidUSD }}</strong></a> <br />Valor Covid BRL:<a href=""><strong>  {{ item.valorCovidBRL }}</strong></a></td>
                                    <td> <p><a class="link" href="{{ item.urlCobertura[2] }}"><strong>Ver cobertura</strong></a></p>  </td>
                                 </tr>
                           </table>
                        </div>
                    </div> 
                </div> 
            </div>

        </div>
  </div> 
       
</div>
